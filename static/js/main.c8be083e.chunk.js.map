{"version":3,"sources":["models/DrawModels.ts","components/PencilButton.tsx","components/PanZoomButton.tsx","components/EraserButton.tsx","actions/Actions.ts","components/CanvasToolbar.tsx","components/Curve.tsx","components/Figure.tsx","components/DrawingCanvas.tsx","components/SmoothEnhancement.tsx","components/PredictEnhancement.tsx","components/EnhancementTabs.tsx","components/App.tsx","reducers/InkDrawSmoothReducer.ts","reducers/InkDrawReducers.ts","reducers/DynamicIdentifiers.ts","reducers/EraserReducers.ts","reducers/CanvasReducers.ts","reducers/Reducers.ts","models/PredictModels.ts","api/InputTools.ts","sagas/StartAppSaga.ts","sagas/RootSaga.ts","services/Store.ts","index.tsx"],"names":["CanvasToolbarSelection","PencilButton","props","active","className","id","aria-label","aria-selected","role","title","color","onClick","xmlns","viewBox","width","height","fill","points","d","PanZoomButton","version","x","y","EraserButton","gradientUnits","x1","y1","x2","y2","gradientTransform","offset","stopColor","stopOpacity","PredictionAction","CanvasAction","ApplicationAction","initialCanvas","smoothWindow","toolSelected","None","inkDraw","committedPoints","projectedPoints","smoothFactor","smoothingBuffer","startedAt","tracking","figures","Array","CanvasToolbar","useSelector","state","canvas","visibility","Black","selectTool","Red","Green","Blue","Eraser","Curve","m","model","path","pathPoints","map","p","i","pathChar","toFixed","join","stroke","strokeColor","strokeOpacity","toBeDeleted","undefined","strokeWidth","Figure","curves","c","key","canvasMsg","name","type","payload","predictionMsg","applicationMsg","DrawingCanvas","tool","dispatch","useDispatch","boundRef","useRef","getMousePosition","e","bounds","current","absolute","relative","rect","getBoundingClientRect","pageX","pageY","left","top","toolSpecificCursor","style","overflow","ref","aria-hidden","onMouseDown","CanvasMouseDown","point","mouseDown","onMouseMove","CanvasMouseMove","mouseMove","onMouseUp","CanvasMouseUp","mouseUp","cx","cy","r","f","SmoothEnhancement","Fragment","htmlFor","value","onChange","smoothWindowChanged","parseInt","target","PredictEnhancement","predictions","slice","s","EnhancementTabs","onTabClick","tabName","tabContent","document","getElementsByClassName","length","setAttribute","tabLinks","replace","getElementById","currentTarget","App","React","useState","setSmoothWindow","quickDraw","topMatches","isStarted","useEffect","StartApplication","ToolSelected","n","InkDrawSmoothReducer","appendToSmoothingBuffer","buffer","timespan","Date","now","shift","getAveragePoint","smoothCount","pt","totalX","totalY","totalTime","count","updateVisiblePoints","extrapolated","push","_","updateRecentCurveWithInkDrawing","lastFigure","pop","lastCurve","penColor","inkDrawMouseDown","curve","shortid","generate","startNewCurve","deleteCurve","newFigures","filter","isPen","eraserMouseDown","inkDrawMouseMove","pointsInsideCursor","curveIdsUnderMouse","from","Set","flatMap","elementsFromPoint","startsWith","figure","flipDeleted","includes","newCurves","j","eraserMouseMove","events","action","CurveCompleted","figureId","curveId","inkDrawMouseUp","canvasReducer","newTool","curveTimes","predictionsReducer","QuickDrawPredictionReceived","initialState","basicShape","shape","inkPayload","input_type","requests","language","writing_guide","ink","v","fetchQuickDrawSuggestions","fetch","method","headers","body","JSON","stringify","curveCompleted","startApplicationSaga","figureById","find","select","then","json","response","put","takeEvery","rootSaga","sagaMiddle","createSagaMiddleware","sagaEnhancer","applyMiddleware","asyncDispatchEnhancer","store","next","syncActivityFinished","actionQueue","flushQueue","forEach","a","actionWithAsyncDispatch","Object","assign","asyncDispatch","actions","concat","result","enhancers","composedEnhancers","compose","createStore","newVar","run","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.c8be083e.chunk.js","sourcesContent":["export interface Point {\r\n    x: number\r\n    y: number\r\n}\r\n\r\nexport interface CanvasPoint {\r\n    relative: Point\r\n    absolute: Point\r\n}\r\n\r\nexport interface TemporalPoint extends Point {\r\n    timespan: number;\r\n}\r\n\r\n\r\nexport interface Curve {\r\n    id: string\r\n    strokeWidth: number | string\r\n    strokeColor: string\r\n    startedAt: number\r\n    pathPoints: TemporalPoint[]\r\n    toBeDeleted: boolean\r\n}\r\n\r\nexport interface Figure {\r\n    id: string\r\n    offset: Point\r\n    curves: Curve[]\r\n    curveTimes: number[]\r\n}\r\n\r\nexport interface InkDraw{\r\n    smoothingBuffer: TemporalPoint[]\r\n\r\n    /**\r\n     * Points that are already part of the curve and will not change.\r\n     */\r\n    committedPoints: TemporalPoint[]\r\n\r\n    /**\r\n     * Projected points\r\n     */\r\n    projectedPoints: TemporalPoint[]\r\n\r\n    /**\r\n     * time when this ink was started to draw\r\n     */\r\n    startedAt: number\r\n    smoothFactor: number\r\n    tracking: boolean\r\n}\r\n\r\nconst DefaultInkDraw: InkDraw = {\r\n    committedPoints: [],\r\n    projectedPoints: [],\r\n    smoothFactor: 1,\r\n    smoothingBuffer: [],\r\n    startedAt: 0,\r\n    tracking: false\r\n}\r\n\r\nexport enum CanvasToolbarSelection {\r\n    None,\r\n    PanZoom,\r\n    Black,\r\n    Red,\r\n    Green,\r\n    Blue,\r\n    Eraser\r\n}\r\n\r\nexport interface Canvas {\r\n    smoothWindow: number\r\n    toolSelected: CanvasToolbarSelection\r\n    inkDraw: InkDraw\r\n    figures: Figure[]\r\n}\r\n\r\nexport const initialCanvas: Canvas = {\r\n    smoothWindow: 1,\r\n    toolSelected: CanvasToolbarSelection.None,\r\n    inkDraw: DefaultInkDraw,\r\n    figures: new Array<Figure>(),\r\n}","import React from 'react';\r\n\r\nexport interface Props {\r\n    color: string\r\n    active: boolean\r\n    onClick: () => void\r\n  }\r\n  \r\n\r\nconst PencilButton: React.FC<Props> = (props) => {\r\n    const active =  props.active ? \" activePen\" : \"\";\r\n    return (\r\n<button \r\n    className={\"chrome-Button pen embedded\" + active}\r\n    id=\"red\" \r\n    aria-label=\"Content Creation Toolbar - Ink Red Pen\" \r\n    aria-selected='false' \r\n    role=\"tab\" \r\n    title={props.color + \" Pen\"}\r\n    onClick={props.onClick}>\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox={\"0 \"+ (props.active ? \"-8\": \"-24\") + \" 96 96\"}>\r\n        <g>\r\n            <rect className=\"pen-0\" width=\"96\" height=\"96\"/>\r\n            <g>\r\n                <g>\r\n                    <polygon fill={props.color} points=\"68.004 96 28 96 29.004 58 67.004 58 68.004 96\"/>\r\n                </g>\r\n                <g>\r\n                    <path fill={props.color} d=\"M55,14C52,4,50,0,47.999,0,46,0,44,4,41,14l.00287,2H54.99713Z\"/>\r\n                </g>\r\n                <g>\r\n                    <path className=\"pen-1\" d=\"M57.00287,16l-2-2h-14l-2,2s-9.16663,22.33325-10,42L29,60H67.00287V58C66.16949,38.33325,57.00287,16,57.00287,16Z\"/>\r\n                </g>\r\n            </g>\r\n            <g>\r\n                <polygon className=\"pen-2\" points=\"36 59 36 96 60 96 60 59 36 59\"/>\r\n                <polygon className=\"pen-3\" points=\"41 15 38 59 58 59 55 15 41 15\"/>\r\n            </g>\r\n            <g>\r\n                <polygon points=\"29.004 58 28 96 30.001 96 30.952 60 65.056 60 66.003 96 68.004 96 67.004 58 29.004 58\"/>\r\n                <path d=\"M47.999,2c.06757,0,.346.15382.645.649l.03763.0623.04206.05941c.0536.07572,1.3214,\r\n                    1.92808,4.1846,11.22925H43.09171C45.956,4.69527,47.22008,2.84621,47.27344,2.77076l.04318-.06067.03855-.06371C47.65355,\r\n                    2.15319,47.93148,2,47.999,2m0-2a2.88457,2.88457,0,0,0-2.355,1.61108C45.383,1.97778,43.97986,4.22339,41,14l.00287,\r\n                    2H54.99713L55,14C52.03259,4.264,50.62592,1.99634,50.356,1.61511A2.88666,2.88666,0,0,0,47.999,0Z\"/>\r\n                <path d=\"M54.17445,16l1.12417,1.12418C56.46608,20.07411,64.22884,40.29125,65.001,\r\n                    58H31.00472c.77218-17.70875,8.53493-37.92589,9.7024-40.87582L41.83129,16H54.17445m.82842-2h-14l-2,2s-9.16663,\r\n                    22.33326-10,42L29,60H67.00287V58c-.83338-19.66674-10-42-10-42l-2-2Z\"/>\r\n            </g>\r\n        </g>\r\n    </svg>\r\n</button>      \r\n    )\r\n }\r\n\r\n export default PencilButton;","import React from 'react';\r\n\r\nexport interface Props {\r\n}\r\n  \r\n\r\nconst PanZoomButton: React.FC<Props> = (props) => {\r\n    return (\r\n        <button id=\"enablePanzoom\" className=\"chrome-Button\" aria-label=\"Move canvas tool\" title=\"Move canvas tool\">\r\n            <svg className=\"enablePanzoomIcon\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" width=\"32px\" height=\"32px\" viewBox=\"0 0 32 32\">\r\n            <path d=\"M4.1,17.1l3.4,3.4L6,22l-6-6l6-6l1.5,1.5l-3.4,3.4h6.6v2.1H4.1z M32,16l-5.9,5.9l-1.5-1.5l3.3-3.3h-6.6v-2.1h6.6l-3.4-3.4\r\n                L26,10L32,16z M11.6,7.4l-1.5-1.5L16,0l6,6l-1.5,1.5l-3.4-3.4v6.6h-2.1V4.1L11.6,7.4z M20.5,24.5L22,26l-6,6l-6-6l1.5-1.5l3.4,3.4\r\n                v-6.6h2.1v6.6L20.5,24.5z\"></path>\r\n            </svg>\r\n        </button>    \r\n    )\r\n }\r\n\r\n export default PanZoomButton;","import React from 'react';\r\n\r\nexport interface Props {\r\n    active: boolean\r\n    onClick: () => void\r\n}\r\n  \r\n\r\nconst EraserButton: React.FC<Props> = (props) => {\r\n    return (\r\n        <button\r\n            className=\"chrome-Button pen embedded\"\r\n            id=\"erase\"\r\n            aria-label=\"Content Creation Toolbar - Ink Eraser\"\r\n            aria-selected=\"false\"\r\n            role=\"tab\"\r\n            title=\"Eraser\"\r\n            onClick={props.onClick}\r\n        >\r\n            <svg version=\"1.1\" id=\"Eraser\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" viewBox={\"0 \"+ (props.active ? \"-8\": \"-24\") + \" 96 96\"}>\r\n                <rect className=\"eraser-0\" width=\"96\" height=\"96\"/>\r\n                <g>\r\n                    <path className=\"eraser-1\" d=\"M38,0h20c4.4,0,8,3.6,8,8v16H30V8C30,3.6,33.6,0,38,0z\"/>\r\n                    <rect x=\"28\" y=\"58\" className=\"eraser-2\" width=\"40\" height=\"38\"/>\r\n                    <polygon className=\"eraser-3\" points=\"30,22 66,22 68,24 68,60 28,60 28,24 \"/>\r\n                        <linearGradient id=\"barrel_highlight_1_\" gradientUnits=\"userSpaceOnUse\" x1=\"36.1318\" y1=\"-1008.9948\" x2=\"60.0228\" y2=\"-1008.9948\" gradientTransform=\"matrix(1 0 0 -1 0 -931.9948)\">\r\n                            <stop offset=\"0.16\" stopColor=\"#FFFFFF\" stopOpacity=\"0\"/>\r\n                            <stop offset=\"0.5\" stopColor=\"#FFFFFF\" stopOpacity=\"0.7\"/>\r\n                            <stop offset=\"0.84\" stopColor=\"#FFFFFF\" stopOpacity=\"0\"/>\r\n                        </linearGradient>\r\n                    <polygon className=\"eraser-4\" points=\"48.2,58 48,58 36,58 36,96 48,96 48.2,96 60,96 60,58 \t\"/>\r\n                        <linearGradient id=\"metal_highlight_1_\" gradientUnits=\"userSpaceOnUse\" x1=\"38.112\" y1=\"-972.9948\" x2=\"58.2844\" y2=\"-972.9948\" gradientTransform=\"matrix(1 0 0 -1 0 -931.9948)\">\r\n                            <stop offset=\"0.16\" stopColor=\"#FFFFFF\" stopOpacity=\"0\"/>\r\n                            <stop offset=\"0.5\" stopColor=\"#FFFFFF\"/>\r\n                            <stop offset=\"0.84\" stopColor=\"#FFFFFF\" stopOpacity=\"0\"/>\r\n                        </linearGradient>\r\n                    <polygon className=\"eraser-5\" points=\"48.2,22 48,22 36,22 36,60 48,60 48.2,60 60,60 60,22 \t\"/>\r\n                </g>\r\n                <path d=\"M66,22V8c0-4.4-3.6-8-8-8H38c-4.4,0-8,3.6-8,8v14l-2,2v72h2V60h36v36h2V24L66,22z M32,8c0-3.2,2.6-6,5.8-6H38\r\n                    h20c3.2,0,6,2.6,6,5.8V8v14H32V8z M30,58V24.8l0.8-0.8h34.4l0.8,0.8V58H30z\"/>\r\n            </svg>\r\n        </button>   \r\n    )\r\n }\r\n\r\n export default EraserButton;","import {CanvasPoint, CanvasToolbarSelection} from \"../models/DrawModels\"\r\nimport {Action} from 'redux'\r\n\r\nexport type ActionMap<M extends { [index: string]: any }> = {\r\n    [Key in keyof M]: M[Key] extends Action\r\n        ? {\r\n            type: Key;\r\n        }\r\n        : {\r\n            type: Key;\r\n            payload: M[Key];\r\n        }\r\n};\r\n\r\nexport function createMsg<Obj extends { [index: string]: any }>() {\r\n    return function<Key extends keyof Obj>(\r\n        name: Key,\r\n        ...args: Obj[Key] extends undefined ? [] : [Obj[Key]]\r\n    ) {\r\n        if (args.length > 0) {\r\n            return { type: name, payload: args[0] };\r\n        }\r\n        return { type: name };\r\n    };\r\n}\r\n\r\n\r\nexport enum PredictionAction {\r\n    QuickDrawPredictionReceived = \"PREDICT_QUICKDRAW_RECEIVED\",\r\n    LookupBasicShape = \"LOOKUP_BASIC_SHAPE\"\r\n}\r\n\r\ntype PredictionMessages = {\r\n    [PredictionAction.QuickDrawPredictionReceived]: string[]\r\n    [PredictionAction.LookupBasicShape]: {};\r\n};\r\n\r\nexport enum CanvasAction {\r\n    ToolSelected = \"CANVAS_SET_TOOL\",\r\n    CanvasMouseDown = \"CANVAS_MOUSE_DOWN\",\r\n    CanvasMouseMove = \"CANVAS_MOUSE_MOVE\",\r\n    CanvasMouseUp = \"CANVAS_MOUSE_UP\",\r\n}\r\n\r\ntype CanvasMessages = {\r\n    [CanvasAction.ToolSelected]: { tool: CanvasToolbarSelection };\r\n    [CanvasAction.CanvasMouseDown]: { point: CanvasPoint };\r\n    [CanvasAction.CanvasMouseMove]: { point: CanvasPoint };\r\n    [CanvasAction.CanvasMouseUp]: { point: CanvasPoint };\r\n};\r\n\r\nexport enum ApplicationAction {\r\n    StartApplication = \"APP_START\",\r\n    CurveCompleted = \"APP_CURVE_COMPLETED\"\r\n}\r\n\r\ntype ApplicationMessages = {\r\n    [ApplicationAction.StartApplication]: { };\r\n    [ApplicationAction.CurveCompleted]: { figureId: string, curveId: string};\r\n};\r\n\r\nexport type PredictionActions = ActionMap<PredictionMessages>[keyof ActionMap<PredictionMessages>];\r\nexport type CanvasActions = ActionMap<CanvasMessages>[keyof ActionMap<CanvasMessages>];\r\nexport type ApplicationActions = ActionMap<ApplicationMessages>[keyof ActionMap<ApplicationMessages>];\r\n\r\nexport const canvasMsg = createMsg<CanvasMessages>();\r\nexport const predictionMsg = createMsg<PredictionMessages>();\r\nexport const applicationMsg = createMsg<ApplicationMessages>();\r\n\r\nexport type AllActions = PredictionActions | CanvasActions | ApplicationActions\r\n\r\nexport interface HasInducedActions {\r\n    asyncDispatch(actions: Action[]): void;\r\n}\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport PencilButton from './PencilButton';\r\nimport PanZoomButton from './PanZoomButton';\r\nimport EraserButton from './EraserButton';\r\nimport {CanvasToolbarSelection} from \"../models/DrawModels\";\r\nimport {useSelector} from \"react-redux\";\r\nimport {ApplicationState} from \"../reducers/Reducers\";\r\n\r\nexport interface Props {\r\n    selectTool: (tool: CanvasToolbarSelection) => void\r\n}\r\n\r\nconst CanvasToolbar: React.FC<Props> = (props) => {\r\n    const toolSelected = useSelector((state: ApplicationState) => state.canvas.toolSelected)\r\n\r\n    return (\r\n        <div id=\"chrome\" className=\"embedded\">\r\n            <svg className=\"svgDefs\" xmlns=\"http://www.w3.org/2000/svg\" visibility=\"hidden\">\r\n                <defs>\r\n                    <linearGradient id=\"pen-linear-gradient\" x1=\"36.1146\" y1=\"1057.5\" x2=\"60.0056\" y2=\"1057.5\" gradientTransform=\"translate(0 -980)\" gradientUnits=\"userSpaceOnUse\">\r\n                        <stop offset=\"0.2\" stopColor=\"#fff\" stopOpacity=\"0\"/>\r\n                        <stop offset=\"0.2048\" stopColor=\"#fff\" stopOpacity=\"0.00948\"/>\r\n                        <stop offset=\"0.2972\" stopColor=\"#fff\" stopOpacity=\"0.1775\"/>\r\n                        <stop offset=\"0.3805\" stopColor=\"#fff\" stopOpacity=\"0.2992\"/>\r\n                        <stop offset=\"0.4509\" stopColor=\"#fff\" stopOpacity=\"0.3734\"/>\r\n                        <stop offset=\"0.5\" stopColor=\"#fff\" stopOpacity=\"0.4\"/>\r\n                        <stop offset=\"0.5576\" stopColor=\"#fff\" stopOpacity=\"0.3835\"/>\r\n                        <stop offset=\"0.6177\" stopColor=\"#fff\" stopOpacity=\"0.3344\"/>\r\n                        <stop offset=\"0.679\" stopColor=\"#fff\" stopOpacity=\"0.2526\"/>\r\n                        <stop offset=\"0.7406\" stopColor=\"#fff\" stopOpacity=\"0.1388\"/>\r\n                        <stop offset=\"0.8\" stopColor=\"#fff\" stopOpacity=\"0\"/>\r\n                    </linearGradient>\r\n                    <linearGradient id=\"pen-linear-gradient-2\" x1=\"39.75\" y1=\"1017\" x2=\"56.5602\" y2=\"1017\" gradientTransform=\"translate(0 -980)\" gradientUnits=\"userSpaceOnUse\">\r\n                        <stop offset=\"0.16\" stopColor=\"#fff\" stopOpacity=\"0\"/>\r\n                        <stop offset=\"0.2179\" stopColor=\"#fff\" stopOpacity=\"0.2236\"/>\r\n                        <stop offset=\"0.2949\" stopColor=\"#fff\" stopOpacity=\"0.4965\"/>\r\n                        <stop offset=\"0.3645\" stopColor=\"#fff\" stopOpacity=\"0.7131\"/>\r\n                        <stop offset=\"0.424\" stopColor=\"#fff\" stopOpacity=\"0.8691\"/>\r\n                        <stop offset=\"0.4711\" stopColor=\"#fff\" stopOpacity=\"0.9648\"/>\r\n                        <stop offset=\"0.5\" stopColor=\"#fff\"/>\r\n                        <stop offset=\"0.5289\" stopColor=\"#fff\" stopOpacity=\"0.9648\"/>\r\n                        <stop offset=\"0.576\" stopColor=\"#fff\" stopOpacity=\"0.8691\"/>\r\n                        <stop offset=\"0.6355\" stopColor=\"#fff\" stopOpacity=\"0.7131\"/>\r\n                        <stop offset=\"0.7051\" stopColor=\"#fff\" stopOpacity=\"0.4965\"/>\r\n                        <stop offset=\"0.7821\" stopColor=\"#fff\" stopOpacity=\"0.2236\"/>\r\n                        <stop offset=\"0.84\" stopColor=\"#fff\" stopOpacity=\"0\"/>\r\n                    </linearGradient>\r\n                </defs>\r\n            </svg>\r\n\r\n            <div id=\"penCalloutToastContainer\" className=\"toastContainer\">\r\n                <div id=\"pens\" className=\"chromeContainer embedded\" role=\"tablist\">\r\n                    <PanZoomButton/>\r\n                    <PencilButton color=\"black\" active={toolSelected === CanvasToolbarSelection.Black} onClick={() => props.selectTool(CanvasToolbarSelection.Black)}/>\r\n                    <PencilButton color=\"red\" active={toolSelected === CanvasToolbarSelection.Red} onClick={() => props.selectTool(CanvasToolbarSelection.Red)}/>\r\n                    <PencilButton color=\"green\" active={toolSelected === CanvasToolbarSelection.Green} onClick={() => props.selectTool(CanvasToolbarSelection.Green)}/>\r\n                    <PencilButton color=\"blue\" active={toolSelected === CanvasToolbarSelection.Blue} onClick={() => props.selectTool(CanvasToolbarSelection.Blue)}/>\r\n                    <EraserButton active={toolSelected === CanvasToolbarSelection.Eraser} onClick={() => props.selectTool(CanvasToolbarSelection.Eraser)}/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default CanvasToolbar;","import React from 'react';\r\nimport {Curve as CurveModel} from '../models/DrawModels'\r\n\r\nexport interface Props {\r\n    model: CurveModel\r\n}\r\nconst Curve: React.FC<Props> = (props) => {\r\n    const m = props.model\r\n    const pathChar = (i: number)  =>  { return i === 0 ? 'M' : 'L'}\r\n    const path = m.pathPoints.map((p, i) => pathChar(i) + p.x.toFixed(1) + \" \" + p.y.toFixed(1)).join(\" \")\r\n    return (\r\n        <path\r\n            id={m.id}\r\n            xmlns = 'http://www.w3.org/2000/svg'\r\n            fill = \"none\"\r\n            stroke = {m.strokeColor}\r\n            strokeOpacity={m.toBeDeleted ? \"25%\" : undefined}\r\n            strokeWidth = {m.strokeWidth}\r\n            d= {path}\r\n        >\r\n        </path>\r\n    )\r\n}\r\n\r\nexport default Curve","import React from 'react'\r\nimport {Figure as FigureModel} from '../models/DrawModels'\r\nimport Curve from './Curve'\r\n\r\nexport interface Props {\r\n    model: FigureModel\r\n}\r\nconst Figure: React.FC<Props> = (props) => {\r\n    const m = props.model\r\n\r\n    return (\r\n        <g\r\n            id={m.id}\r\n            x={m.offset.x}\r\n            y={m.offset.y}\r\n        >\r\n            {m.curves.map((c, i) =>\r\n                <Curve model={c} key={i} />\r\n            )}\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default Figure","import React, {useRef} from 'react'\r\nimport CSS from 'csstype'\r\nimport {CanvasPoint, CanvasToolbarSelection} from '../models/DrawModels'\r\nimport Figure from './Figure'\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {ApplicationState} from \"../reducers/Reducers\";\r\nimport {CanvasAction} from \"../actions/Actions\";\r\n\r\nconst DrawingCanvas: React.FC = () => {\r\n\r\n    const tool = useSelector((state: ApplicationState) => state.canvas.toolSelected)\r\n    const figures = useSelector((state: ApplicationState) => state.canvas.figures)\r\n    const dispatch = useDispatch()\r\n\r\n    const svgParentStyles: CSS.Properties = {\r\n        overflow: 'hidden'\r\n    };\r\n\r\n    const boundRef = useRef<HTMLElement>(null);\r\n\r\n    const mouseDown = (e: React.MouseEvent<SVGSVGElement>): void => {\r\n        dispatch({\r\n            type: CanvasAction.CanvasMouseDown,\r\n            payload: {point: getMousePosition(e)}\r\n        })\r\n    }\r\n\r\n    const mouseMove = (e: React.MouseEvent<SVGSVGElement>): void => {\r\n\r\n        dispatch({\r\n            type: CanvasAction.CanvasMouseMove,\r\n            payload: {point: getMousePosition(e)}\r\n        })\r\n    }\r\n\r\n    const mouseUp = (e: React.MouseEvent<SVGSVGElement>): void => {\r\n        dispatch({\r\n            type: CanvasAction.CanvasMouseUp,\r\n            payload: {point: getMousePosition(e)}\r\n        })\r\n    }\r\n\r\n    const getMousePosition = (e: React.MouseEvent): CanvasPoint =>   {\r\n        const bounds = boundRef.current;\r\n        if (!bounds)\r\n            return {\r\n                absolute: {x: 0, y: 0},\r\n                relative: {x: 0, y: 0}\r\n            }\r\n\r\n        const rect = bounds.getBoundingClientRect();\r\n\r\n        return {\r\n            absolute: {x: e.pageX, y: e.pageY},\r\n            relative: {x: e.pageX - rect.left, y: e.pageY - rect.top}\r\n        }\r\n    }\r\n\r\n    const toolSpecificCursor = tool === CanvasToolbarSelection.Eraser ? \" eraseActive\" : \"\";\r\n    return (\r\n        <div id=\"svgParent\" className={\"flexAlignCenter\" + toolSpecificCursor} style={svgParentStyles}>\r\n            <main id=\"svg\"\r\n                  ref={boundRef}\r\n                  aria-label=\"Whiteboard Canvas. Capture your ideas and collaborate with others\"\r\n                  >\r\n                <svg aria-hidden=\"true\"\r\n                     onMouseDown={(e) => mouseDown(e)}\r\n                     onMouseMove={(e) => mouseMove(e)}\r\n                     onMouseUp={(e) => mouseUp(e)}\r\n                     xmlns=\"http://www.w3.org/2000/svg\"\r\n                    //  viewBox=\"0 0 1000 1000\"\r\n                     height=\"1000\"\r\n                     width=\"1000\">\r\n                    <g id=\"canvas-decorators\">\r\n                        <circle cx=\"0\" cy=\"0\" r=\"40\" fill=\"rgba(0,105,191,1)\" />\r\n                        <circle cx=\"0%\" cy=\"100%\" r=\"40\" fill=\"rgba(0,105,191,1)\" />\r\n                        <circle cx=\"100%\" cy=\"0%\" r=\"40\" fill=\"rgba(0,105,191,1)\" />\r\n                        <circle cx=\"100%\" cy=\"100%\" r=\"40\" fill=\"rgba(0,105,191,1)\" />\r\n                    </g>\r\n                    <g id=\"canvas-figures\">\r\n                        {figures.map((f, i) =>\r\n                            <Figure key={i} model={f}/>\r\n                        )}\r\n                    </g>\r\n                </svg>\r\n            </main>\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default DrawingCanvas;\r\n","import React from 'react';\r\n\r\nexport interface Props {\r\n    smoothWindow: number\r\n    smoothWindowChanged: (window: number) => void\r\n}\r\n\r\nconst SmoothEnhancement: React.FC<Props> = (props) => {\r\n\r\nreturn (\r\n    <React.Fragment>\r\n        <h3>Smoothing</h3>\r\n        <p>Simplifies the line by averaging specified number of points.</p>\r\n\r\n    <div id=\"divSmoothingFactor\">\r\n        <label htmlFor=\"cmbBufferSize\">Buffer size:</label>\r\n        <select id=\"cmbBufferSize\" value={props.smoothWindow} onChange={(e) => props.smoothWindowChanged(parseInt(e.target.value))}>\r\n            <option value=\"1\">1 - No smoothing</option>\r\n            <option value=\"4\">4 - Sharp curves</option>\r\n            <option value=\"8\">8 - Smooth curves</option>\r\n            <option value=\"12\">12 - Very smooth curves</option>\r\n            <option value=\"16\">16 - Super smooth curves</option>\r\n            <option value=\"20\">20 - Hyper smooth curves</option>\r\n        </select>\r\n    </div>\r\n    </React.Fragment>\r\n)};\r\n\r\n\r\nexport default SmoothEnhancement;","import React from 'react';\r\n\r\nexport interface Props {\r\n    predictions: string[]\r\n}\r\n\r\nconst PredictEnhancement: React.FC<Props> = (props) => {\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <h3>Recognize the drawing</h3>\r\n            <p>Draw any figure (mug, apple, cat, mosquito, house) using one ink pen color:</p>\r\n            <ul>\r\n                {props.predictions.slice(0, 5).map((s, i) => {\r\n                    return <li key={i}>{s}</li>;\r\n                })}\r\n            </ul>\r\n        </React.Fragment>\r\n    )};\r\n\r\n\r\nexport default PredictEnhancement;","import React from 'react';\r\nimport SmoothEnhancement from './SmoothEnhancement';\r\nimport PredictEnhancement from './PredictEnhancement';\r\n\r\n\r\nexport interface Props {\r\n    smoothWindow: number\r\n    smoothWindowChanged: (window: number) => void\r\n    predictions: string[]\r\n}\r\n\r\nconst EnhancementTabs: React.FC<Props> = (props) => {\r\n\r\n    const onTabClick = (e: React.MouseEvent<HTMLButtonElement>, tabName: string) => {\r\n        const tabContent = document.getElementsByClassName(\"tabcontent\");\r\n        for (let i = 0; i < tabContent.length; i++) {\r\n            const tab = tabContent[i] as HTMLDivElement\r\n            tab.setAttribute(\"style\", \"display=none\");\r\n        }\r\n        const tabLinks = document.getElementsByClassName(\"tablinks\");\r\n        for (let i = 0; i < tabLinks.length; i++) {\r\n          tabLinks[i].className = tabLinks[i].className.replace(\" active\", \"\");\r\n        }\r\n        document.getElementById(tabName)?.setAttribute(\"style\", \"display: block\")\r\n        e.currentTarget.className += \" active\";\r\n    }\r\n\r\n    return (\r\n        <div id=\"footer\">\r\n            <p>There are some tabs below with whiteboard drawing enhancements:</p>\r\n\r\n            <div className=\"tab\">\r\n            <button className=\"tablinks\" onClick={(e) => onTabClick(e, \"simplify\")}>Smooth</button>\r\n            <button className=\"tablinks\" onClick={(e) => onTabClick(e, \"predict\")}>Predict</button>\r\n            <button className=\"tablinks\" onClick={(e) => onTabClick(e, \"shape\")}>Autoshape</button>\r\n            </div>\r\n\r\n            <div id=\"simplify\" className=\"tabcontent\">\r\n                <SmoothEnhancement smoothWindow={props.smoothWindow} smoothWindowChanged={props.smoothWindowChanged}/>\r\n            </div>\r\n\r\n            <div id=\"predict\" className=\"tabcontent\">\r\n                <PredictEnhancement predictions={props.predictions} />\r\n            </div>\r\n\r\n            <div id=\"shape\" className=\"tabcontent\">\r\n                <PredictEnhancement predictions={props.predictions} />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nexport default EnhancementTabs;","import React, {useEffect, useState} from 'react';\nimport CanvasToolbar from './CanvasToolbar';\nimport DrawingCanvas  from './DrawingCanvas';\nimport EnhancementTabs from './EnhancementTabs';\nimport '../App.css';\nimport {CanvasToolbarSelection} from \"../models/DrawModels\";\nimport {ApplicationAction, applicationMsg, CanvasAction} from \"../actions/Actions\";\nimport {ApplicationState} from \"../reducers/Reducers\";\nimport {useDispatch, useSelector} from \"react-redux\";\n\nexport default function App() {\n  const [smoothWindow, setSmoothWindow] = React.useState(1);\n\n  const predictions = useSelector((state: ApplicationState) => state.predictions.quickDraw.topMatches)\n  const dispatch = useDispatch()\n  const [isStarted] = useState(false)\n\n  useEffect(() => {\n    if (!isStarted) {\n      dispatch(applicationMsg(ApplicationAction.StartApplication, {}))\n    }\n  },    // having readonly dependency ensures that effect will run only on componentDidMount and not on every updates.\n      [isStarted, dispatch])\n\n\n  const selectTool = (tool: CanvasToolbarSelection) => {\n    dispatch( {\n      type: CanvasAction.ToolSelected,\n      payload: { tool: tool }\n    })\n  };\n\n  return (\n      <div className=\"App\">\n        <CanvasToolbar selectTool={tool => selectTool(tool)}/>\n        <DrawingCanvas/>\n        <EnhancementTabs smoothWindow={smoothWindow} smoothWindowChanged={(n: number) => setSmoothWindow(n)}\n                         predictions={predictions}/>\n      </div>\n  );\n}\n\n","import {InkDraw, Point, TemporalPoint} from \"../models/DrawModels\";\r\n\r\nexport class InkDrawSmoothReducer {\r\n\r\n    private static appendToSmoothingBuffer = (p: Point, model: InkDraw): InkDraw => {\r\n\r\n        let buffer = [...model.smoothingBuffer, { ...p, timespan: Date.now() - model.startedAt}];\r\n        if (buffer.length > model.smoothFactor) {\r\n            buffer.shift();\r\n        }\r\n\r\n        return {\r\n            ...model,\r\n            smoothingBuffer: buffer\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculate the average point, starting at offset in the smooth window in buffer\r\n     */\r\n    private static getAveragePoint = (offset: number, model: InkDraw) : TemporalPoint | null => {\r\n\r\n        const smoothCount = model.smoothingBuffer.length;\r\n        if (smoothCount % 2 === 1 || smoothCount >= model.smoothFactor) {\r\n            let totalX = 0;\r\n            let totalY = 0;\r\n            let totalTime = 0;\r\n            let pt, i;\r\n            let count = 0;\r\n            for (i = offset; i < smoothCount; i++) {\r\n                count++;\r\n                pt = model.smoothingBuffer[i];\r\n                totalX += pt.x;\r\n                totalY += pt.y;\r\n                totalTime += pt.timespan\r\n            }\r\n            return {\r\n                x: totalX / count,\r\n                y: totalY / count,\r\n                timespan: totalTime / count\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private static updateVisiblePoints = (model: InkDraw): InkDraw =>  {\r\n        let p = InkDrawSmoothReducer.getAveragePoint(0, model);\r\n\r\n        if (p) {\r\n            // append to the smoothed part of the path that will not change\r\n            const committedPoints = [...model.committedPoints, p];\r\n\r\n            // Get the last part of the path (close to the current mouse position)\r\n            // This part will change if the mouse moves again\r\n            const extrapolated : TemporalPoint[] = [];\r\n            for (let offset = 2; offset < model.smoothingBuffer.length; offset += 2) {\r\n                p = InkDrawSmoothReducer.getAveragePoint(offset, model)\r\n                if (p != null)\r\n                    extrapolated.push(p);\r\n            }\r\n\r\n            return {\r\n                ...model,\r\n                projectedPoints: [...committedPoints, ...extrapolated],\r\n                committedPoints: committedPoints\r\n            }\r\n        }\r\n\r\n        return model\r\n    }\r\n\r\n    public static mouseDown = (model: InkDraw, p: Point): InkDraw => {\r\n        model = {\r\n            ...model,\r\n            smoothingBuffer: [],\r\n            projectedPoints: [],\r\n            committedPoints: [],\r\n            startedAt: Date.now(),\r\n            tracking:  true\r\n        }\r\n\r\n        model = InkDrawSmoothReducer.appendToSmoothingBuffer(p, model);\r\n        InkDrawSmoothReducer.updateVisiblePoints(model);\r\n\r\n        return {\r\n            ...model,\r\n        }\r\n    };\r\n\r\n    public static mouseMove = (model: InkDraw, p: Point): InkDraw => {\r\n        if (model.tracking) {\r\n            model = InkDrawSmoothReducer.appendToSmoothingBuffer(p, model);\r\n            model = InkDrawSmoothReducer.updateVisiblePoints(model);\r\n        }\r\n        return model;\r\n    };\r\n\r\n    public static mouseUp = (model: InkDraw, _: Point): InkDraw => {\r\n        return {\r\n            ...model,\r\n            tracking: false\r\n        }\r\n    };\r\n\r\n\r\n\r\n}\r\n\r\n","import {Canvas, CanvasToolbarSelection, Curve, Figure, Point, TemporalPoint} from \"../models/DrawModels\";\r\nimport {InkDrawSmoothReducer} from \"./InkDrawSmoothReducer\";\r\nimport {Action} from \"redux\";\r\nimport {ApplicationAction, applicationMsg} from \"../actions/Actions\";\r\nimport {generateCurveId} from \"./DynamicIdentifiers\";\r\n\r\nexport const updateRecentCurveWithInkDrawing = (figures: Figure[], projectedPoints: TemporalPoint[]): Figure[] => {\r\n    const lastFigure = figures.pop()!\r\n    let curves = lastFigure.curves;\r\n    const lastCurve: Curve = curves.pop()!\r\n    lastCurve.pathPoints = [...projectedPoints]\r\n    return [...figures, {...lastFigure, curves: [...curves, lastCurve]}]\r\n}\r\n\r\nexport function inkDrawMouseMove(state: Canvas, point: Point): Canvas {\r\n    if (!state.inkDraw.tracking)\r\n        return state\r\n    const inkDraw = InkDrawSmoothReducer.mouseMove(state.inkDraw, point)\r\n    return {\r\n        ...state,\r\n        inkDraw: inkDraw,\r\n        figures: updateRecentCurveWithInkDrawing(state.figures, state.inkDraw.projectedPoints)\r\n    }\r\n}\r\n\r\nconst penColor = (toolSelected: CanvasToolbarSelection) => {\r\n    switch (toolSelected) {\r\n        case CanvasToolbarSelection.Black:\r\n            return \"black\"\r\n        case CanvasToolbarSelection.Blue:\r\n            return \"blue\"\r\n        case CanvasToolbarSelection.Green:\r\n            return \"green\"\r\n        case CanvasToolbarSelection.Red:\r\n            return \"red\"\r\n\r\n        default:\r\n            return \"black\"\r\n    }\r\n}\r\n\r\nconst startNewCurve = (figures: Figure[], startedAt: number, toolSelected: CanvasToolbarSelection, projectedPoints: TemporalPoint[]): Figure[] => {\r\n    const lastFigure = figures.pop()!;\r\n\r\n    const curve: Curve = {\r\n        startedAt: startedAt,\r\n        id: generateCurveId(),\r\n        pathPoints: [],\r\n        strokeColor: penColor(toolSelected),\r\n        strokeWidth: 3,\r\n        toBeDeleted: false\r\n    }\r\n\r\n    curve.pathPoints = [...projectedPoints]\r\n    return [...figures, {...lastFigure, curves: [...lastFigure.curves, curve]}]\r\n}\r\n\r\nexport const inkDrawMouseDown = (state: Canvas, point: Point) => {\r\n    const inkDraw = InkDrawSmoothReducer.mouseDown(state.inkDraw, point);\r\n    const figures = startNewCurve(state.figures, inkDraw.startedAt, state.toolSelected, inkDraw.projectedPoints);\r\n    return {\r\n        ...state,\r\n        inkDraw: inkDraw,\r\n        figures: figures\r\n    }\r\n};\r\n\r\nexport const inkDrawMouseUp = (state: Canvas, point: Point, events: Action[]) => {\r\n    const inkDraw = InkDrawSmoothReducer.mouseUp(state.inkDraw, point)\r\n    const figures = updateRecentCurveWithInkDrawing(state.figures, state.inkDraw.projectedPoints);\r\n    const figure = figures[figures.length - 1]\r\n    const curve = figure.curves[figure.curves.length - 1]\r\n    const action = applicationMsg(ApplicationAction.CurveCompleted, {figureId: figure.id, curveId: curve.id});\r\n    events.push(action)\r\n    return {\r\n        ...state,\r\n        inkDraw: inkDraw,\r\n        figures: figures\r\n    }\r\n};","import shortid from \"shortid\";\r\n\r\nconst figureIdPrefix = \"Fig_\"\r\nconst curveIdPrefix = \"Cur_\"\r\n\r\nexport const generateFigureId = () => {\r\n    return figureIdPrefix + shortid.generate()\r\n}\r\nexport const generateCurveId = () => {\r\n    return curveIdPrefix + shortid.generate()\r\n}\r\n\r\nexport const isCurveId = (id: string) => id?.startsWith(curveIdPrefix)","import {Canvas, Figure, Point} from \"../models/DrawModels\";\r\nimport {isCurveId} from \"./DynamicIdentifiers\";\r\n\r\nconst deleteCurve = (figures: Figure[]): Figure[] => {\r\n    const newFigures = [...figures]\r\n    for (let i = 0; i < newFigures.length; i++)\r\n        newFigures[i] = {\r\n            ...newFigures[i],\r\n            curves: newFigures[i].curves.filter(c => !c.toBeDeleted)\r\n        };\r\n    return newFigures.filter(f => f.curves.length > 0)\r\n}\r\n\r\nexport const eraserMouseDown = (state: Canvas) => {\r\n    return {\r\n        ...state,\r\n        figures: deleteCurve(state.figures)\r\n    }\r\n}\r\n\r\nexport const eraserMouseMove = (state: Canvas, point: Point): Canvas => {\r\n    const pointsInsideCursor: Point[] = [\r\n        {x: point.x-2, y: point.y-2},\r\n        {x: point.x-2, y: point.y-1},\r\n        {x: point.x-2, y: point.y},\r\n        {x: point.x-2, y: point.y+1},\r\n        {x: point.x-2, y: point.y+2},\r\n\r\n        {x: point.x-1, y: point.y-2},\r\n        {x: point.x-1, y: point.y-1},\r\n        {x: point.x-1, y: point.y},\r\n        {x: point.x-1, y: point.y+1},\r\n        {x: point.x-1, y: point.y+2},\r\n\r\n        {x: point.x, y: point.y-2},\r\n        {x: point.x, y: point.y-1},\r\n        {x: point.x, y: point.y},\r\n        {x: point.x, y: point.y+1},\r\n        {x: point.x, y: point.y+2},\r\n\r\n        {x: point.x+1, y: point.y-2},\r\n        {x: point.x+1, y: point.y-1},\r\n        {x: point.x+1, y: point.y},\r\n        {x: point.x+1, y: point.y+1},\r\n        {x: point.x+1, y: point.y+2},\r\n\r\n        {x: point.x+2, y: point.y-2},\r\n        {x: point.x+2, y: point.y-1},\r\n        {x: point.x+2, y: point.y},\r\n        {x: point.x+2, y: point.y+1},\r\n        {x: point.x+2, y: point.y+2},\r\n    ]\r\n\r\n    const curveIdsUnderMouse = Array.from(new Set(pointsInsideCursor.flatMap(p => document.elementsFromPoint(p.x, p.y))))\r\n        .filter(e => isCurveId(e.id))\r\n        .map(e => e.id)\r\n\r\n    const newFigures = [...state.figures]\r\n    for (let i = 0; i < newFigures.length; i++){\r\n        const figure = newFigures[i];\r\n        const flipDeleted = figure.curves.filter(c => c.toBeDeleted !== curveIdsUnderMouse.includes(c.id)).map((c, i) => i)\r\n        if (flipDeleted.length > 0) {\r\n            const newCurves = [...figure.curves]\r\n            for (const j of flipDeleted) {\r\n                newCurves[j] = {...newCurves[j], toBeDeleted: !newCurves[j].toBeDeleted}\r\n            }\r\n            newFigures[i] = {...figure, curves: newCurves}\r\n        }\r\n    }\r\n\r\n    return {\r\n        ...state,\r\n        figures: newFigures\r\n    }\r\n}","import {Canvas, CanvasPoint, CanvasToolbarSelection, Figure, Point} from \"../models/DrawModels\";\r\nimport {Action} from \"redux\";\r\nimport {CanvasAction, CanvasActions} from \"../actions/Actions\";\r\nimport {inkDrawMouseDown, inkDrawMouseMove, inkDrawMouseUp} from \"./InkDrawReducers\";\r\nimport {eraserMouseDown, eraserMouseMove} from \"./EraserReducers\";\r\nimport {generateFigureId} from \"./DynamicIdentifiers\";\r\n\r\nexport const createNewFigure = (): Figure => {\r\n    return {\r\n        id: generateFigureId(),\r\n        offset: {x: 0, y: 0},\r\n        curves: [],\r\n        curveTimes: []\r\n    }\r\n};\r\n\r\nconst isPen = (tool: CanvasToolbarSelection) => {\r\n    switch (tool) {\r\n        case CanvasToolbarSelection.Black:\r\n        case CanvasToolbarSelection.Blue:\r\n        case CanvasToolbarSelection.Green:\r\n        case CanvasToolbarSelection.Red:\r\n            return true\r\n        default:\r\n            return false\r\n    }\r\n}\r\n\r\nconst selectTool = (state: Canvas, newTool: CanvasToolbarSelection) => {\r\n    let figures = state.figures;\r\n\r\n    if (isPen(newTool)) {\r\n        figures = [...state.figures, createNewFigure()]\r\n    }\r\n\r\n    return {\r\n        ...state,\r\n        toolSelected: newTool,\r\n        figures: figures\r\n    };\r\n};\r\n\r\nconst mouseDown = (state: Canvas, point: CanvasPoint): Canvas => {\r\n    if (isPen(state.toolSelected))\r\n        return inkDrawMouseDown(state, point.relative);\r\n\r\n    if (state.toolSelected === CanvasToolbarSelection.Eraser)\r\n        return eraserMouseDown(state);\r\n\r\n    return state;\r\n}\r\n\r\nconst mouseMove = (state: Canvas, point: CanvasPoint): Canvas => {\r\n    if (isPen(state.toolSelected))\r\n        return inkDrawMouseMove(state, point.relative);\r\n\r\n    if (state.toolSelected === CanvasToolbarSelection.Eraser)\r\n        return eraserMouseMove(state, point.absolute);\r\n\r\n    return state\r\n\r\n}\r\n\r\nconst mouseUp = (state: Canvas, point: Point, events: Action[]): Canvas => {\r\n    if (isPen(state.toolSelected))\r\n        return inkDrawMouseUp(state, point, events);\r\n\r\n    return state\r\n\r\n}\r\nexport const canvasReducer = (state: Canvas, action: CanvasActions, events: Action[]): Canvas => {\r\n    switch (action.type) {\r\n        case CanvasAction.ToolSelected:\r\n            return selectTool(state, action.payload.tool)\r\n        case CanvasAction.CanvasMouseDown:\r\n            return mouseDown(state, action.payload.point)\r\n        case CanvasAction.CanvasMouseMove:\r\n            return mouseMove(state, action.payload.point)\r\n        case CanvasAction.CanvasMouseUp:\r\n            return mouseUp(state, action.payload.point.relative, events)\r\n        default:\r\n            return state;\r\n    }\r\n}","import {AllActions, CanvasActions, HasInducedActions, PredictionAction, PredictionActions} from \"../actions/Actions\";\r\nimport {Canvas, initialCanvas} from \"../models/DrawModels\";\r\nimport {DefaultPredictions, Predictions} from \"../models/PredictModels\";\r\nimport {Action, Reducer} from \"redux\";\r\nimport {canvasReducer} from \"./CanvasReducers\";\r\n\r\n\r\nexport const predictionsReducer = (state: Predictions, action: PredictionActions) : Predictions => {\r\n    switch (action.type) {\r\n        case PredictionAction.QuickDrawPredictionReceived:\r\n            return {\r\n                ...state,\r\n                quickDraw:  {\r\n                    topMatches: action.payload\r\n                }\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport interface ApplicationState {\r\n    canvas: Canvas\r\n    predictions: Predictions\r\n}\r\n\r\nexport const initialState : ApplicationState = {\r\n    canvas: initialCanvas,\r\n    predictions: DefaultPredictions\r\n}\r\n\r\nexport const rootReducer : Reducer<ApplicationState, AllActions> = (state = initialState, action) => {\r\n    let events: Action[] = [];\r\n    const newVar = {\r\n        predictions: predictionsReducer(state.predictions, action as PredictionActions),\r\n        canvas: canvasReducer(state.canvas, action as CanvasActions, events)\r\n    } as ApplicationState;\r\n\r\n    const asyncDispatch = (action as any as HasInducedActions).asyncDispatch;\r\n    if (asyncDispatch)\r\n        asyncDispatch(events);\r\n\r\n    return newVar\r\n}\r\n\r\n\r\n\r\n","export interface QuickdrawPredictions {\r\n    topMatches: string[]\r\n}\r\n\r\nexport interface BasicShapePredictions {\r\n    shape: string\r\n}\r\n\r\nexport interface Predictions {\r\n    quickDraw: QuickdrawPredictions\r\n    basicShape: BasicShapePredictions\r\n}\r\n\r\nexport const DefaultPredictions: Predictions = {\r\n    quickDraw: { topMatches: [] },\r\n    basicShape: {shape: ''}\r\n}\r\n\r\n","import {Figure, TemporalPoint} from \"../models/DrawModels\";\r\n\r\nexport const inkPayload = (width: number, height: number, figure: Figure) => {\r\n    let curves: TemporalPoint[][] = []\r\n    for (const curve of figure.curves) {\r\n        curves.push(curve.pathPoints.map((p) => ({\r\n            ...p,\r\n            timespan: p.timespan + curve.startedAt - figure.curves[0].startedAt\r\n        } as TemporalPoint)))\r\n    }\r\n\r\n    return {\r\n        input_type: 0,\r\n        requests: [\r\n            {\r\n                language: \"quickdraw\",\r\n                writing_guide: { width: width, height: height},\r\n                ink: curves.map(c => [\r\n                    c.map(v => v.x),\r\n                    c.map(v => v.y),\r\n                    c.map(v => v.timespan)\r\n                ])\r\n            }\r\n        ]\r\n    }\r\n}\r\n\r\n\r\nexport const fetchQuickDrawSuggestions = (width: number, height: number, figure: Figure) => {\r\n    const url = 'https://inputtools.google.com/request?ime=handwriting&app=quickdraw&dbg=1&cs=1&oe=UTF-8';\r\n        return fetch(url, {\r\n            method: \"POST\",\r\n/*\r\n            mode: \"cors\",\r\n            cache: \"no-cache\",\r\n            redirect: \"follow\",\r\n*/\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(inkPayload(width, height, figure))\r\n        })\r\n}\r\n\r\n","import { put, takeEvery, select } from 'redux-saga/effects';\r\nimport {\r\n    ApplicationAction,\r\n    ApplicationActions,\r\n    CanvasAction,\r\n    canvasMsg,\r\n    PredictionAction,\r\n    predictionMsg\r\n} from \"../actions/Actions\";\r\nimport {CanvasToolbarSelection} from \"../models/DrawModels\";\r\nimport {fetchQuickDrawSuggestions} from \"../api/InputTools\";\r\nimport {ApplicationState} from \"../reducers/Reducers\";\r\n\r\nconst figureById = (state: ApplicationState, figureId: string) => state.canvas.figures.find(value => value.id === figureId)!\r\n\r\nfunction* curveCompleted(action: ApplicationActions) {\r\n    if (action.type === ApplicationAction.CurveCompleted) {\r\n        const {figureId} = action.payload\r\n        const figure: ReturnType<typeof figureById> = yield select(figureById, figureId)\r\n\r\n        const response = yield fetchQuickDrawSuggestions(1000, 1000, figure).then(r => r.json())\r\n        const predictions = response[1][0][1]\r\n        yield put(predictionMsg(PredictionAction.QuickDrawPredictionReceived, predictions))\r\n    }\r\n}\r\n\r\nexport function* startApplicationSaga() {\r\n    // Set tool to black ink on startup. Later we can load last tool from config\r\n    yield put( canvasMsg(CanvasAction.ToolSelected, { tool: CanvasToolbarSelection.Black}))\r\n\r\n    // yield put() show demo\r\n\r\n    yield takeEvery(ApplicationAction.CurveCompleted, curveCompleted);\r\n}\r\n\r\n","import { takeEvery} from 'redux-saga/effects';\r\nimport {ApplicationAction} from \"../actions/Actions\";\r\nimport {startApplicationSaga} from \"./StartAppSaga\";\r\n\r\nexport function* rootSaga() {\r\n    yield takeEvery(ApplicationAction.StartApplication, startApplicationSaga)\r\n}\r\n\r\n\r\n/*\r\n// Event iterator\r\nfunction events(target, event) {\r\n    let fns = [], handler = e => {\r\n        fns.forEach(fn => fn(null, e));\r\n        fns = [];\r\n    };\r\n    target.addEventListener(event, handler);\r\n\r\n    return {\r\n        next(fn) {\r\n            fns.push(fn);\r\n        },\r\n        dispose(){\r\n            target.removeEventListener(event, handler);\r\n            fns = handler = null;\r\n        }\r\n    }\r\n}\r\n\r\nfunction * draw(){\r\n    while(true){\r\n        // wait until mousedown event\r\n        let e = yield take('mousedown');\r\n        e.payload.preventDefault();\r\n        e.payload.stopPropagation();\r\n\r\n\r\n        // start listening to mousemove and mouseup events\r\n        let up$ = events(window, 'mouseup');\r\n        let move$ = events(window, 'mousemove');\r\n\r\n\r\n        while(true){\r\n            let {move} = yield race({\r\n                up: cps(up$.next),\r\n                move: cps(move$.next)\r\n            });\r\n\r\n            if(move){\r\n                move.preventDefault();\r\n                move.stopPropagation();\r\n                let {pageX, pageY} = move;\r\n                yield setState({pageX, pageY});\r\n            }\r\n            else break;\r\n        }\r\n\r\n        // cleanup\r\n        up$.dispose();\r\n        move$.dispose();\r\n    }\r\n\r\n}*/\r\n","import createSagaMiddleware from \"redux-saga\";\r\nimport {Action, applyMiddleware, compose, createStore, Middleware, StoreEnhancer} from \"redux\";\r\nimport {initialState, rootReducer} from \"../reducers/Reducers\";\r\nimport {rootSaga} from \"../sagas/RootSaga\";\r\nimport {Saga} from \"@redux-saga/types\";\r\n\r\nconst sagaMiddle = createSagaMiddleware();\r\n\r\nconst sagaEnhancer = applyMiddleware(sagaMiddle);\r\n\r\nfunction asyncDispatchMiddleware(): Middleware {\r\n    return store => next => action =>\r\n    {\r\n        let syncActivityFinished = false;\r\n        let actionQueue: Action[] = [];\r\n\r\n        function flushQueue() {\r\n            actionQueue.forEach(a => store.dispatch(a)); // flush queue\r\n            actionQueue = [];\r\n        }\r\n\r\n        function asyncDispatch(actions: Action[]) {\r\n            actionQueue = actionQueue.concat(actions);\r\n\r\n            if (syncActivityFinished) {\r\n                flushQueue();\r\n            }\r\n        }\r\n\r\n        const actionWithAsyncDispatch =\r\n            Object.assign({}, action, {asyncDispatch});\r\n\r\n        const result = next(actionWithAsyncDispatch);\r\n        syncActivityFinished = true;\r\n        flushQueue();\r\n        return result\r\n    }\r\n}\r\n\r\n\r\nconst asyncDispatchEnhancer = applyMiddleware(asyncDispatchMiddleware());\r\n\r\n\r\nconst enhancers = [sagaEnhancer]\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n    const devToolsExtension = (window as any).__REDUX_DEVTOOLS_EXTENSION__ && (window as any).__REDUX_DEVTOOLS_EXTENSION__();\r\n    if (typeof devToolsExtension === 'function') {\r\n        enhancers.push(devToolsExtension)\r\n    }\r\n}\r\n\r\nconst composedEnhancers = compose(asyncDispatchEnhancer, ...enhancers)\r\n\r\nexport const store = createStore(rootReducer, initialState, composedEnhancers as StoreEnhancer);\r\n\r\nsagaMiddle.run(rootSaga);\r\n\r\nexport const runSaga = <S extends Saga>(saga: S, ...args: Parameters<S>) => {\r\n    if (!sagaMiddle) {\r\n        console.warn('sage middleware should be initialized first');\r\n        return;\r\n    }\r\n    return sagaMiddle.run(saga, ...args);\r\n};\r\n\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport { Provider } from 'react-redux';\nimport {store} from \"./services/Store\";\n\n\nReactDOM.render(\n    <React.StrictMode>\n        <Provider store={store}>\n            <App/>\n        </Provider>\n    </React.StrictMode>,\n    document.getElementById('root') as HTMLElement)\n"],"sourceRoot":""}